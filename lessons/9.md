# DependÃªncias entre testes

> ğŸ§‘â€ğŸ« Testes devem ser independentes uns dos outros!

Ã‰ comum encontrar testes automatizados que precisam ser executados em ordem para que todos passem.

Imagine um simples CRUD (_Create, Read, Update, Delete_) de produtos.

VocÃª poderia ter a seguinte suÃ­te de testes, por exemplo.

```js
describe('Products CRUD', () => {
  it('creates a product', () => {
    // Passos para criar o produto

    // VerificaÃ§Ã£o de que o produto foi criado
  })

  it('reads a product', () => {
    // Passos para ler o produto criado pelo teste anterior

    // VerificaÃ§Ã£o de que o produto existe
  })

  it('updates a product', () => {
    // Passos para atualizar o produto lido no teste anterior

    // VerificaÃ§Ã£o de que o produto foi atualizado
  })

  it('deletes a product', () => {
    // Passos para deletar o produto atualizado no teste anterior

    // VerificaÃ§Ã£o de que o produto foi deletado
  })
})

```

PorÃ©m, se o primero teste falhar, todos os outros falharÃ£o tambÃ©m. Isso acontece, pois, a criaÃ§Ã£o (_Create_) Ã© prÃ©-condiÃ§Ã£o para leitura (_Read_), a qual Ã© prÃ©-condiÃ§Ã£o para a atualizaÃ§Ã£o (_Update_), a qual, por fim, Ã© prÃ©-condiÃ§Ã£o para a deleÃ§Ã£o (_Delete_).

Em casos como este, Ã© melhor ter sÃ³ um teste, do que vÃ¡rios testes dependentes uns dos outros (veja um exemplo abaixo).

```js
describe('Products CRUD', () => {
  it('CRUDs a product', () => {
    // Passos para criar o produto

    // VerificaÃ§Ã£o de que o produto foi criado

    // Passos para ler o produto

    // VerificaÃ§Ã£o de que o produto existe

    // Passos para atualizar o produto

    // VerificaÃ§Ã£o de que o produto foi atualizado

    // Passos para deletar o produto

    // VerificaÃ§Ã£o de que o produto foi deletado
  })
})

```

Essa nÃ£o Ã© a situacÃ£o ideal, mas ao menos, o teste Ã© independente.

> ğŸ§‘â€ğŸ« Para melhores forma de otimizar testes e tornÃ¡-los ainda mais independentes, recomendo o [curso intermediÃ¡rio de Cypress](https://www.udemy.com/course/testes-automatizados-com-cypress-intermediario/?referralCode=F14505FB0076672E51A2) da [Escola Talking About Testing](https://www.udemy.com/user/walmyr/).

Lembre-se!

> Testes devem ser independentes uns dos outros!


## ExercÃ­cio

> âš ï¸ Antes de seguir adiante, acesse a URL http://notes-serverless-app.com/signup, crie uma conta na aplicaÃ§Ã£o em teste e salve seu usuÃ¡rio e senha no arquivo (nÃ£o versionado) `cypress.env.json`, nas propriedades `user_email` e `user_password` respectivamenteâ—
>
> Seu arquivo deve se parecer com o demonstrado abaixo.

```json
{
  "user_email": "seu-usuario@exemplo.com",
  "user_password": "sua-senha-secreta-utilizada-no-signup-anterior"
}

```

> âš ï¸ Para completar o processo de _signup_, vocÃª terÃ¡ que preencher um cÃ³digo de seis dÃ­gitos enviado para o email cadastrado, poranto, utilize um email vÃ¡lidoâ—

Abra o arquivo [cypress/e2e/dependent-tests/sample.cy.js](../cypress/e2e/dependent-tests/sample.cy.js) e refatore-o para que em vez de um teste depender do outro, haja sÃ³ um teste para todos os passos e verificaÃ§Ãµes do CRUD.

> Perceba que o novo teste consolidado Ã© mais rÃ¡pidos que os testes separados, visto que agora, sÃ³ precisamos fazer _login_ uma vez. ğŸï¸

___

Estamos quase lÃ¡. ğŸ

VÃ¡ para a [aula 10](./10.md) para conhecer a dÃ©cima mÃ¡ prÃ¡tica (abstraÃ§Ãµes erradas) e como lidar com ela.
